<div class="row p-3 m-4 border">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="row mt-2">
      <div class="col-12">
        username
        <input
          formControlName="username"
          placeholder="Username"
          class="form-control form-control-sm"
          type="text"
          aria-label=".form-control-sm example"
        />
        @if (form.controls.username.invalid && form.controls.username.touched) {
        <div style="color: red">Username richiesto</div>
        }
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-12">
        email
        <input
          formControlName="email"
          placeholder="Email"
          class="form-control form-control-sm"
          type="text"
          aria-label=".form-control-sm example"
        />
        @if (form.controls.email.invalid && form.controls.email.touched) {
        <div style="color: red">Email non valida</div>
        }
      </div>
    </div>
    <div class="row mt-2">
      <div class="col-3">
        @if (isModifica()) {
        <button
          type="submit"
          [disabled]="form.invalid"
          class="btn btn-primary"
          (click)="putModificaUtente()"
        >
          Modifica
        </button>
        <button
          type="button"
          (click)="isModifica.set(false); utenteSelected.set(null);"
          class="btn btn-danger"
        >
          Annulla
        </button>
        } @else {
        <button type="submit" [disabled]="form.invalid" class="btn btn-primary">
          Inserisci
        </button>

        }
      </div>
    </div>
  </form>
</div>

<div class="row p-3 m-4 border">
  <table class="table table-dark table-striped">
    <thead>
      <tr>
        <th scope="col">Username</th>
        <th scope="col">email</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      @for (utente of utenti(); track $index; let i = $index) {
      <tr>
        <td class="col-4">{{utente.username}}</td>
        <td class="col-4">{{utente.email}}</td>
        <td class="col-2 text-end">
          <!-- Pulsante modifica -->
          <button
            class="btn btn-sm btn-outline-warning me-2"
            (click)="modificaUtente(utente)"
          >
            <i class="bi bi-pencil-square"></i>
          </button>

          <!-- Pulsante elimina -->
          <button
            class="btn btn-sm btn-outline-danger"
            (click)="eliminaUtente(utente)"
          >
            <i class="bi bi-trash3-fill"></i>
          </button>
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>
